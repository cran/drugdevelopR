<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Johannes Cepicka" />


<title>More parameters to adapt to specific settings</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">More parameters to adapt to specific
settings</h1>
<h4 class="author">Johannes Cepicka</h4>



<p>Suppose we are planning a drug development program testing the
superiority of an experimental treatment over a control treatment. Our
drug development program consists of an exploratory phase II trial which
is, in case of promising results, followed by a confirmatory phase III
trial.</p>
<p>The drugdevelopR package enables us to optimally plan such programs
using a utility-maximizing approach. To get a brief introduction, we
presented a very basic example on how the package works in <a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html">Introduction
to planning phase II and phase III trials with drugdevelopR</a>.
However, there are many more parameters, which you can provide to adapt
the program to your specific needs. In this article, we therefore want
to present the options you have.</p>
<div id="the-example-setting-and-the-input-parameters" class="section level1">
<h1>The example setting and the input parameters</h1>
<p>We are in the same setting as in the introduction, i.e. we suppose we
are developing a new tumor treatment, <em>exper</em>. The patient
variable that we want to investigate is the difference in tumor width
between the one-year visit and baseline. This is a normally distributed
outcome variable.</p>
<p>The parameters we insert into the function
<code>optimum_normal</code> are the same parameters we also inserted in
the basic setting. Thus, for more information on the input values we
refer to the <a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html">introduction</a>.
We start by loading the drugdevelopR package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(drugdevelopR)</span></code></pre></div>
<p>Back then, we got the following output:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>res</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; Optimization result:</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;  Utility: 2946.07</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;  Sample size:</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;    phase II: 92, phase III: 192, total: 284</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;  Probability to go to phase III: 1</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;  Total cost:</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;    phase II: 77, phase III: 158, cost constraint: Inf</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;  Fixed cost:</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;    phase II: 15, phase III: 20</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;  Variable cost per patient:</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;    phase II: 0.675, phase III: 0.72</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  Success probability: 0.85</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;    small: 0.72, medium: 0.12, large: 0</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  Significance level: 0.025</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;  Decision rule threshold: 0.06 [Kappa] </span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt;  Assumed true effect: 0.625 [Delta] </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma]</span></span></code></pre></div>
<p>We now want to see how different modifications, i.e. using more
parameters change the outcome of the program.</p>
<div id="fixed-treatment-effect-estimates-or-prior-distributions" class="section level2">
<h2>Fixed treatment effect estimates or prior distributions</h2>
<p>Setting the parameter <code>fixed</code> to be <code>FALSE</code>
models the assumed true treatment effect using a prior distribution.
This is explained in detail in the article <a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html"><em>Fixed
effect estimates and prior distributions</em></a>.</p>
</div>
<div id="constrained-optimization" class="section level2">
<h2>Constrained optimization</h2>
<p>The are three options how to include constrained optimization, by
setting maximum cost limits, by setting a maximum number of participants
or by demanding a minimum probability of a successful program. These
options can be applied separately or combined, as it is best suited to
your specific needs.</p>
<div id="cost-constraint-maximum-total-costs" class="section level3">
<h3>Cost constraint – maximum total costs</h3>
<p>The total costs are given as sum of the cost in phase II and phase
III, i.e. as <span class="math inline">\(K2\)</span> + <span class="math inline">\(K3\)</span>. In our example we get total costs of
<span class="math inline">\(72+139=211\)</span> (in 10^5 $). Let’s
assume an investor in your drug or a pharmaceutical company is only
willing to pay 20,000,000 $. You can now set a maximum cost constraint
by providing an parameter value of <code>K = 200</code> into the
<code>optimum_normal</code> function. The default value for
<code>K</code> is <code>Inf</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a> resK <span class="ot">&lt;-</span> <span class="fu">optimal_normal</span>(<span class="at">Delta1 =</span> <span class="fl">0.625</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="co"># treatment effect</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                       <span class="at">n2min =</span> <span class="dv">20</span>, <span class="at">n2max =</span> <span class="dv">400</span>, <span class="co"># sample size region</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                       <span class="at">stepn2 =</span> <span class="dv">4</span>, <span class="co"># sample size step size</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                       <span class="at">kappamin =</span> <span class="fl">0.02</span>, <span class="at">kappamax =</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>                       <span class="at">stepkappa =</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>                       <span class="at">c2 =</span> <span class="fl">0.675</span>, <span class="at">c3 =</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>                       <span class="at">c02 =</span> <span class="dv">15</span>, <span class="at">c03 =</span> <span class="dv">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>                       <span class="at">b1 =</span> <span class="dv">3000</span>, <span class="at">b2 =</span> <span class="dv">8000</span>, <span class="at">b3 =</span> <span class="dv">10000</span>, <span class="co"># gains for patients</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="co"># one-sided significance level</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>                       <span class="at">Delta2 =</span> <span class="cn">NULL</span>, <span class="at">w =</span> <span class="cn">NULL</span>, <span class="at">in1 =</span> <span class="cn">NULL</span>, <span class="at">in2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>                       <span class="at">a =</span> <span class="cn">NULL</span>,<span class="at">b =</span> <span class="cn">NULL</span>, <span class="co"># setting all unneeded parameters to NULL</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>                       <span class="at">K =</span> <span class="dv">200</span> <span class="co"># cost constraint</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>                       ) </span></code></pre></div>
<p>We get the following results:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>resK</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; Optimization result:</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt;  Utility: 2846.69</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">#&gt;  Sample size:</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">#&gt;    phase II: 76, phase III: 158, total: 234</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt;  Probability to go to phase III: 0.97</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt;  Total cost:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;    phase II: 66, phase III: 133, cost constraint: 200</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  Fixed cost:</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;    phase II: 15, phase III: 20</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt;  Variable cost per patient:</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt;    phase II: 0.675, phase III: 0.72</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt;  Success probability: 0.82</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt;    small: 0.7, medium: 0.11, large: 0</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;  Significance level: 0.025</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt;  Decision rule threshold: 0.18 [Kappa] </span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt;  Assumed true effect: 0.625 [Delta] </span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma]</span></span></code></pre></div>
<p>We see that due to the cost constraint the cost in phase II decreases
from 77 to 66 and the cost in phase III decreases from 158 to 133, so
overall the constraint is met. Moreover, the expected utility at the
optimum decreases from 294 607 000 to 284 669 000 dollars.</p>
</div>
<div id="sample-size-constraint-maximum-number-of-participants" class="section level3">
<h3>Sample size constraint – maximum number of participants</h3>
<p>Very similarly to the cost constraint, we can set a constraint on the
maximum number of participants in our trial. Without constraints, we
need a total number of 250 participants in the optimum. However, one can
certainly imagine a situation, where the only 200 persons willing to
participate in a trial, for example because the incidence of the illness
is not very high within the target population. To model this, we can
easily set a sample size constraint, in this case of
<code>N = 200</code>. This allows for an optimal allocation of the
participants between phase II and III. The default value for
<code>N</code> is <code>Inf</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a> resN <span class="ot">&lt;-</span> <span class="fu">optimal_normal</span>(<span class="at">Delta1 =</span> <span class="fl">0.625</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="co"># treatment effect</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>                       <span class="at">n2min =</span> <span class="dv">20</span>, <span class="at">n2max =</span> <span class="dv">400</span>, <span class="co"># sample size region</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>                       <span class="at">stepn2 =</span> <span class="dv">4</span>, <span class="co"># sample size step size</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>                       <span class="at">kappamin =</span> <span class="fl">0.02</span>, <span class="at">kappamax =</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>                       <span class="at">stepkappa =</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                       <span class="at">c2 =</span> <span class="fl">0.675</span>, <span class="at">c3 =</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                       <span class="at">c02 =</span> <span class="dv">15</span>, <span class="at">c03 =</span> <span class="dv">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                       <span class="at">b1 =</span> <span class="dv">3000</span>, <span class="at">b2 =</span> <span class="dv">8000</span>, <span class="at">b3 =</span> <span class="dv">10000</span>, <span class="co"># gains for patients</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="co"># significance level</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>                       <span class="at">Delta2 =</span> <span class="cn">NULL</span>, <span class="at">w =</span> <span class="cn">NULL</span>, <span class="at">in1 =</span> <span class="cn">NULL</span>, <span class="at">in2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>                       <span class="at">a =</span> <span class="cn">NULL</span>,<span class="at">b =</span> <span class="cn">NULL</span>, <span class="co"># setting all unneeded parameters to NULL</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>                       <span class="at">N =</span> <span class="dv">200</span> <span class="co"># sample size constraint</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>                       ) </span></code></pre></div>
<p>We get the following results:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>resN</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; Optimization result:</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt;  Utility: 2658.9</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;  Sample size:</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;    phase II: 48, phase III: 150, total: 198</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  Probability to go to phase III: 0.93</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;  Total cost:</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;    phase II: 47, phase III: 127, cost constraint: Inf</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt;  Fixed cost:</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;    phase II: 15, phase III: 20</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt;  Variable cost per patient:</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;    phase II: 0.675, phase III: 0.72</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt;  Success probability: 0.76</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt;    small: 0.65, medium: 0.11, large: 0</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt;  Significance level: 0.025</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt;  Decision rule threshold: 0.2 [Kappa] </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt;  Assumed true effect: 0.625 [Delta] </span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma]</span></span></code></pre></div>
<p>Due to our sample size constraint to optimal number of participants
in phase II is 48 and 150 in phase III (down from 92 and 192
respectively) within this framework. The expected utility in the optimum
decreases to 265 890 000$.</p>
</div>
<div id="success-probability-constraint---minimum-probability-of-a-successful-program" class="section level3">
<h3>Success probability constraint - minimum probability of a successful
program</h3>
<p>The last option provided for constraint optimization is the minimum
probability of a successful program. In our basic setting without
constraints, we had a probability that the program was successful of
0.85, i.e. we had a probability of 0.85 that the program would proceed
from phase II to phase III and that a positive treatment effect could be
detected in phase III. Let’s say, you are willing to have higher costs
and in return want this probability to be 0.87. You can include this
within the framework, by including the parameter <code>S</code> and by
setting it to <code>S = 0.87</code>. The default value for
<code>S</code> is <code>-Inf</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a> resS <span class="ot">&lt;-</span> <span class="fu">optimal_normal</span>(<span class="at">Delta1 =</span> <span class="fl">0.625</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="co"># treatment effect</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                       <span class="at">n2min =</span> <span class="dv">20</span>, <span class="at">n2max =</span> <span class="dv">400</span>, <span class="co"># sample size region</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                       <span class="at">stepn2 =</span> <span class="dv">4</span>, <span class="co"># sample size step size</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                       <span class="at">kappamin =</span> <span class="fl">0.02</span>, <span class="at">kappamax =</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>                       <span class="at">stepkappa =</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                       <span class="at">c2 =</span> <span class="fl">0.675</span>, <span class="at">c3 =</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                       <span class="at">c02 =</span> <span class="dv">15</span>, <span class="at">c03 =</span> <span class="dv">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>                       <span class="at">b1 =</span> <span class="dv">3000</span>, <span class="at">b2 =</span> <span class="dv">8000</span>, <span class="at">b3 =</span> <span class="dv">10000</span>, <span class="co"># gains for patients</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="co"># significance level</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                       <span class="at">Delta2 =</span> <span class="cn">NULL</span>, <span class="at">w =</span> <span class="cn">NULL</span>, <span class="at">in1 =</span> <span class="cn">NULL</span>, <span class="at">in2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>                       <span class="at">a =</span> <span class="cn">NULL</span>,<span class="at">b =</span> <span class="cn">NULL</span>, <span class="co"># setting all unneeded parameters to NULL</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>                       <span class="at">S =</span> <span class="fl">0.87</span> <span class="co">#minimum success probability</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>                       ) </span></code></pre></div>
<p>We get the following results:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>resS</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; Optimization result:</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt;  Utility: 2906.94</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt;  Sample size:</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt;    phase II: 172, phase III: 138, total: 310</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt;  Probability to go to phase III: 1</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;  Total cost:</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt;    phase II: 131, phase III: 119, cost constraint: Inf</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt;  Fixed cost:</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt;    phase II: 15, phase III: 20</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt;  Variable cost per patient:</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt;    phase II: 0.675, phase III: 0.72</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="co">#&gt;  Success probability: 0.87</span></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt;    small: 0.76, medium: 0.11, large: 0</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;  Significance level: 0.025</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt;  Decision rule threshold: 0.06 [Kappa] </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;  Assumed true effect: 0.625 [Delta] </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma]</span></span></code></pre></div>
<p>The probability of a successful program now increased from 0.85 to
0.87, mainly by increasing the number of participants in phase II. The
expected utility decreased to 290 694 000 $.</p>
</div>
</div>
<div id="customized-effect-size-categories" class="section level2">
<h2>Customized effect size categories</h2>
<p>Up until now, the effect size categories for a small, medium or large
treatment effect were predefined and set to <span class="math inline">\(0-0.5\)</span> for a small treatment effect, <span class="math inline">\(0.5-0.8\)</span> for a medium treatment effect and
<span class="math inline">\(\geq 0.8\)</span> for a large treatment
effect (each in standardized differences in mean). These parameter
values were taken from Cohen (1988). However, one can easily customize
the effect size categories by inserting threshold values for each effect
size. Let’s say you only consider a program successful if the treatment
effect is above 0.1. Furthermore, you want to assign a medium benefit if
the treatment effect is between 0.6 and 1 and a large benefit if the
treatment effect is above 1. Note that there is a one-to-one relation
between effect size categories and benefit categories, i.e. the large
treatment effect corresponds to the large benefit and so on. If you want
to implement this scenario you can do this by defining the parameters
<code>steps1</code>, <code>stepm1</code> and <code>stepl1</code>. Here,
we set them to <code>steps1 = 0.1</code>, <code>stepm1 = 0.6</code> and
<code>stepl1 = 1</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a> res <span class="ot">&lt;-</span> <span class="fu">optimal_normal</span>(<span class="at">Delta1 =</span> <span class="fl">0.625</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="co"># treatment effect</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>                       <span class="at">n2min =</span> <span class="dv">20</span>, <span class="at">n2max =</span> <span class="dv">400</span>, <span class="co"># sample size region</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>                       <span class="at">stepn2 =</span> <span class="dv">4</span>, <span class="co"># sample size step size</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                       <span class="at">kappamin =</span> <span class="fl">0.02</span>, <span class="at">kappamax =</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>                       <span class="at">stepkappa =</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>                       <span class="at">c2 =</span> <span class="fl">0.675</span>, <span class="at">c3 =</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>                       <span class="at">c02 =</span> <span class="dv">15</span>, <span class="at">c03 =</span> <span class="dv">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                       <span class="at">b1 =</span> <span class="dv">3000</span>, <span class="at">b2 =</span> <span class="dv">8000</span>, <span class="at">b3 =</span> <span class="dv">10000</span>, <span class="co"># gains for patients</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="co"># significance level</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>                       <span class="at">Delta2 =</span> <span class="cn">NULL</span>, <span class="at">w =</span> <span class="cn">NULL</span>, <span class="at">in1 =</span> <span class="cn">NULL</span>, <span class="at">in2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>                       <span class="at">a =</span> <span class="cn">NULL</span>,<span class="at">b =</span> <span class="cn">NULL</span>, <span class="co"># setting all unneeded parameters to NULL</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>                       <span class="at">steps1 =</span> <span class="fl">0.1</span>, <span class="at">stepm1 =</span> <span class="fl">0.6</span>, <span class="at">stepl1 =</span> <span class="dv">1</span> <span class="co"># step sizes for effect size categories</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>                       ) </span></code></pre></div>
</div>
<div id="differences-in-the-treatment-effect" class="section level2">
<h2>Differences in the treatment effect</h2>
<p>Due to different population structures in phase II and phase III, the
assumed true treatment effect <code>Delta1</code> may not be the same in
both phases. Phase III trials are often conducted in populations that
are more heterogeneous than those of the preceding phase II trials
(Kirby et al., 2012), so the effect in phase III may differ from that in
phase II. In order to model these differences, one can use the parameter
<code>gamma</code>. The treatment effect in phase III is then calculated
as follows: <span class="math inline">\(\Delta_3 = \Delta_2 +
\gamma\)</span>. Values of gamma below zero indicate a more pessimistic
view, values above zero indicate a more optimistic view about the
treatment effect in the confirmatory phase. The default value of
<code>gamma</code> is zero.</p>
</div>
<div id="skipping-phase-ii" class="section level2">
<h2>Skipping phase II</h2>
<p>If enough information is available, one may decide to skip the phase
II trial and move directly to a confirmatory trial. This can be
integrated in the framework by using the parameter <code>skipII</code>.
If we set the parameter <code>TRUE</code>, the program calculates the
expected utility for the case when phase II is skipped and compares it
to the situation when phase II is not skipped. When skipping phase II,
the assumed treatment effect used for planning the phase III trial is
calculated as the median of the prior distribution. The results are then
returned as a two-row data frame, <code>res[1, ]</code> being the
results when including phase II and <code>res[2, ]</code> when skipping
phase II. The default value is <code>skipII = FALSE</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a> resII <span class="ot">&lt;-</span> <span class="fu">optimal_normal</span>(<span class="at">Delta1 =</span> <span class="fl">0.625</span>, <span class="at">fixed =</span> <span class="cn">TRUE</span>, <span class="co"># treatment effect</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>                       <span class="at">n2min =</span> <span class="dv">20</span>, <span class="at">n2max =</span> <span class="dv">400</span>, <span class="co"># sample size region</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>                       <span class="at">stepn2 =</span> <span class="dv">4</span>, <span class="co"># sample size step size</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>                       <span class="at">kappamin =</span> <span class="fl">0.02</span>, <span class="at">kappamax =</span> <span class="fl">0.2</span>, <span class="co"># threshold region</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>                       <span class="at">stepkappa =</span> <span class="fl">0.02</span>, <span class="co"># threshold step size</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                       <span class="at">c2 =</span> <span class="fl">0.675</span>, <span class="at">c3 =</span> <span class="fl">0.72</span>, <span class="co"># maximal total trial costs</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>                       <span class="at">c02 =</span> <span class="dv">15</span>, <span class="at">c03 =</span> <span class="dv">20</span>, <span class="co"># maximal per-patient costs</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                       <span class="at">b1 =</span> <span class="dv">3000</span>, <span class="at">b2 =</span> <span class="dv">8000</span>, <span class="at">b3 =</span> <span class="dv">10000</span>, <span class="co"># gains for patients</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>                       <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="co"># significance level</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                       <span class="at">beta =</span> <span class="fl">0.1</span>, <span class="co"># 1 - power</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>                       <span class="at">Delta2 =</span> <span class="cn">NULL</span>, <span class="at">w =</span> <span class="cn">NULL</span>, <span class="at">in1 =</span> <span class="cn">NULL</span>, <span class="at">in2 =</span> <span class="cn">NULL</span>, </span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                       <span class="at">a =</span> <span class="cn">NULL</span>,<span class="at">b =</span> <span class="cn">NULL</span>, <span class="co"># setting all unneeded parameters to NULL</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>                       <span class="at">skipII =</span> <span class="cn">TRUE</span> <span class="co">#skipping phase II</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>                       ) </span></code></pre></div>
<p>We get the following results:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>resII</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Optimization result including phase II:</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt;  Utility: 2946.07</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;  Sample size:</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt;    phase II: 92, phase III: 192, total: 284</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt;  Probability to go to phase III: 1</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt;  Total cost:</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt;    phase II: 77, phase III: 158, cost constraint: Inf</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;  Fixed cost:</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt;    phase II: 15, phase III: 20</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;  Variable cost per patient:</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt;    phase II: 0.675, phase III: 0.72</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt;  Success probability: 0.85</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt;    small: 0.72, medium: 0.12, large: 0</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;  Significance level: 0.025</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt;  Decision rule threshold: 0.06 [Kappa] </span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt;  Assumed true effect: 0.625 [Delta] </span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma] </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; Result when skipping phase II:</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt;  Utility: 3080.46</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt;  Sample size:</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt;    phase II: 0, phase III: 108, total: 108</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt;  Probability to go to phase III: 1</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt;  Total cost:</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt;    phase II: 0, phase III: 98, cost constraint: Inf</span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt;  Fixed cost:</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;    phase II: 0, phase III: 20</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt;  Variable cost per patient:</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt;    phase II: 0, phase III: 0.72</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt;  Effect size categories (expected gains):</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt;   small: 0 (3000), medium: 0.5 (8000), large: 0.8 (10000)</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt;  Success probability: 0.9</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt;  Joint probability of success and observed effect of size ... in phase III:</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt;    small: 0.81, medium: 0.09, large: 0</span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt;  Significance level: 0.025</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt;  Targeted power: 0.9</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt;  Decision rule threshold: -Inf [Kappa] </span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt;  Assumed true effect: 0.62 [Delta] </span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt;  Treatment effect offset between phase II and III: 0 [gamma] </span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; Skipping phase II is the optimal option with respect to the maximal expected utility.</span></span></code></pre></div>
<p>It can be seen that in this case skipping phase II yields a higher
utility than including phase II. Skipping phase II automatically sets
<code>n2 = O</code> which leads to costs <code>K2 = 0</code>. Hence,
overall costs are smaller in our example. Furthermore, note that the
optimal threshold value <code>Kappa</code> is also automatically set to
<code>-Inf</code> and the probability to go to phase III
<code>pgo = 1</code>, as we go to phase III every time, when skipping
phase II.</p>
</div>
<div id="parallel-computing" class="section level2">
<h2>Parallel computing</h2>
<p>As some of the programs may have very long run-times, especial more
complex ones, faster computing is enabled by parallel programming. The
parameter <code>num_cl</code> allows you to set the number of cores for
parallel computing. It is advisable to check the number of cores
available by using the function <code>detectCores()</code>. The default
value is <code>num_cl = 1</code>. Note that using this parameters does
not change the results, but can decrease run-time.</p>
</div>
</div>
<div id="where-to-go-from-here" class="section level1">
<h1>Where to go from here</h1>
<p>This tutorial presents more parameters, so you can adapt the program
to your specific needs. For more information on how to use the package,
see:</p>
<ul>
<li><a href="https://sterniii3.github.io/drugdevelopR/articles/Introduction-to-drugdevelopR.html"><em>Introduction
to drugdevelopR:</em></a> See how the package works in a basic
example.</li>
<li><em>Different outcomes:</em> Apply it to <a href="https://sterniii3.github.io/drugdevelopR/articles/Binary_outcomes.html">binary
endpoints</a> and <a href="https://sterniii3.github.io/drugdevelopR/articles/Time-to-event_outcomes.html">time-to-event
endpoints</a>.</li>
<li><a href="https://sterniii3.github.io/drugdevelopR/articles/Interpreting_Output.html"><em>Interpreting
the rest of the output:</em></a> Obtain further details on your drug
development program.</li>
<li><a href="https://sterniii3.github.io/drugdevelopR/articles/Fixed_and_prior_distributions.html"><em>Fixed
or prior:</em></a> Model the assumed treatment effect on a prior
distribution.</li>
<li><em>Complex drug development programs:</em> Adapt to situations with
<a href="https://sterniii3.github.io/drugdevelopR/articles/Bias_adjustment.html">biased
effect estimators</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multitrial.html">multiple
phase III trials</a>, <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiarm_Trials.html">multi-arm
trials</a>, or <a href="https://sterniii3.github.io/drugdevelopR/articles/Multiple_Endpoints.html">multiple
endpoints</a>.</li>
</ul>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Cohen, J. (1988). Statistical power analysis for the behavioral
sciences.</p>
<p>Kirby, S., Burke, J., Chuang-Stein, C., and Sin, C. (2012).
Discounting phase 2 results when planning phase 3 clinical trials.
Pharmaceutical Statistics, 11(5):373–385.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
